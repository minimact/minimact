<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net472</TargetFramework>
    <ImplicitUsings>disable</ImplicitUsings>
    <Nullable>disable</Nullable>
    <OutputType>Library</OutputType>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <!-- Bridge.NET Configuration -->
    <BridgeVersion>17.10.0</BridgeVersion>
    <OutputPath>bin\$(Configuration)\</OutputPath>
    <DefineConstants>BRIDGE</DefineConstants>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Bridge" Version="17.10.0" />
    <PackageReference Include="Bridge.Core" Version="17.10.0" />
    <PackageReference Include="Bridge.Html5" Version="17.10.0" />
  </ItemGroup>

  <PropertyGroup>
    <!-- Bridge output settings -->
    <BridgeConfiguration>Release</BridgeConfiguration>
    <BridgeOutputFileName>minimact-workers.js</BridgeOutputFileName>
    <BridgeOutputFormatting>Formatted</BridgeOutputFormatting>
    <BridgeModule>none</BridgeModule>
    <BridgeSourceMap>true</BridgeSourceMap>
  </PropertyGroup>

  <!-- Copy output to minimact-punch workers directory for comparison -->
  <Target Name="CopyBridgeOutput" AfterTargets="Build">
    <ItemGroup>
      <BridgeOutputFiles Include="$(OutputPath)**\*.js" />
      <BridgeOutputFiles Include="$(OutputPath)**\*.js.map" />
    </ItemGroup>
    <Copy SourceFiles="@(BridgeOutputFiles)" DestinationFolder="..\..\minimact-punch\src\workers\generated\" SkipUnchangedFiles="true" />
  </Target>

</Project>